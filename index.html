<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GreenPoints App</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <style>
        .animate-bounce {
            animation: bounce 1s infinite;
        }
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        .animate-pulse {
            animation: pulse 2s infinite;
        }
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-in;
        }
        .animate-slideUp {
            animation: slideUp 0.4s ease-out;
        }
        .gradient-bg {
            background: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%);
        }
        .glass-effect {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        .card-hover {
            transition: all 0.3s ease;
        }
        .card-hover:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        .success-gradient {
            background: linear-gradient(135deg, #10b981, #059669);
        }
        .points-counter {
            background: linear-gradient(135deg, #fbbf24, #f59e0b);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% { transform: translate3d(0, 0, 0); }
            40%, 43% { transform: translate3d(0, -15px, 0); }
            70% { transform: translate3d(0, -7px, 0); }
            90% { transform: translate3d(0, -2px, 0); }
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slideUp {
            from { transform: translateY(100%); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .font-sans {
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
        }
        #qr-reader {
            width: 100%;
            max-width: 300px;
            margin: 0 auto;
        }
        #qr-reader__camera_selection {
            display: none;
        }
        #qr-reader__start_button, #qr-reader__stop_button {
            background: #059669 !important;
            border-radius: 12px !important;
            padding: 12px 24px !important;
            font-weight: 600 !important;
            margin: 10px 0 !important;
        }
        #qr-reader video {
            border-radius: 20px !important;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3) !important;
        }
        .scanner-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 200px;
            border: 3px solid #10b981;
            border-radius: 20px;
            background: transparent;
            pointer-events: none;
            z-index: 10;
        }
        .scanner-overlay::before {
            content: '';
            position: absolute;
            top: -3px;
            left: -3px;
            width: 40px;
            height: 40px;
            border-left: 6px solid #10b981;
            border-top: 6px solid #10b981;
            border-radius: 10px 0 0 0;
        }
        .scanner-overlay::after {
            content: '';
            position: absolute;
            bottom: -3px;
            right: -3px;
            width: 40px;
            height: 40px;
            border-right: 6px solid #10b981;
            border-bottom: 6px solid #10b981;
            border-radius: 0 0 10px 0;
        }
        .floating-button {
            box-shadow: 0 8px 25px rgba(5, 150, 105, 0.4);
            transition: all 0.3s ease;
        }
        .floating-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(5, 150, 105, 0.5);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app" class="max-w-sm mx-auto bg-white shadow-2xl min-h-screen font-sans overflow-hidden">
        <!-- App content will be rendered here -->
    </div>

    <script>
        // App state
        let currentScreen = 'login';
        let userPoints = 245;
        let showConfetti = false;
        let onboardingStep = 0;
        let scanningQR = false;
        let selectedReward = null;
        let showRedemptionQR = false;
        let activeTab = 'individual';
        let qrScanner = null;
        let cameraPermissionGranted = false;

        // Data (same as before)
        const rewards = [
            { id: 1, name: 'Canteen 20% Off', category: 'food', points: 50, icon: 'coffee', color: 'bg-orange-100 text-orange-600' },
            { id: 2, name: 'Free Notebook', category: 'stationery', points: 80, icon: 'book-open', color: 'bg-blue-100 text-blue-600' },
            { id: 3, name: 'VIP Event Entry', category: 'events', points: 150, icon: 'ticket', color: 'bg-purple-100 text-purple-600' },
            { id: 4, name: 'Pizza Combo', category: 'food', points: 120, icon: 'coffee', color: 'bg-red-100 text-red-600' },
            { id: 5, name: 'Eco Bag', category: 'stationery', points: 60, icon: 'book-open', color: 'bg-green-100 text-green-600' },
            { id: 6, name: 'Concert Pass', category: 'events', points: 200, icon: 'ticket', color: 'bg-indigo-100 text-indigo-600' }
        ];

        const leaderboard = [
            { rank: 1, name: 'Sarah Chen', points: 1250, dept: 'Computer Science', badge: 'Zero-Waste Hero' },
            { rank: 2, name: 'Alex Kumar', points: 1180, dept: 'Mechanical Eng', badge: 'Plastic Smasher' },
            { rank: 3, name: 'Maya Patel', points: 950, dept: 'Environmental Sci', badge: 'Eco Champion' },
            { rank: 4, name: 'You', points: userPoints, dept: 'Computer Science', badge: 'Green Rookie' },
            { rank: 5, name: 'John Smith', points: 220, dept: 'Business Admin', badge: 'Green Rookie' }
        ];

        const teamLeaderboard = [
            { rank: 1, name: 'Computer Science', points: 12500, members: 45 },
            { rank: 2, name: 'Mechanical Engineering', points: 11200, members: 38 },
            { rank: 3, name: 'Environmental Science', points: 9800, members: 28 }
        ];

        const badges = [
            { name: 'Green Rookie', desc: 'Started your eco journey', unlocked: true, icon: 'üå±' },
            { name: 'Plastic Smasher', desc: 'Recycled 50+ plastic items', unlocked: false, icon: '‚ôªÔ∏è' },
            { name: 'Eco Champion', desc: 'Reach 500 GreenPoints', unlocked: false, icon: 'üèÜ' },
            { name: 'Zero-Waste Hero', desc: 'Recycled for 30 days straight', unlocked: false, icon: '‚≠ê' }
        ];

        const recyclingHistory = [
            { date: '2025-09-23', type: 'Plastic Bottle', points: 10, bin: 'BIN-CLG-2025-001' },
            { date: '2025-09-22', type: 'Paper Cup', points: 5, bin: 'BIN-CLG-2025-003' },
            { date: '2025-09-21', type: 'Aluminum Can', points: 15, bin: 'BIN-CLG-2025-002' },
            { date: '2025-09-20', type: 'Plastic Bottle', points: 10, bin: 'BIN-CLG-2025-001' }
        ];

        // Enhanced helper functions
        function setCurrentScreen(screen) {
            currentScreen = screen;
            renderCurrentScreen();
        }

        async function initQRScanner() {
            try {
                const qrReader = document.getElementById('qr-reader');
                if (!qrReader) return;

                qrScanner = new Html5QrcodeScanner("qr-reader", {
                    fps: 10,
                    qrbox: { width: 250, height: 250 },
                    aspectRatio: 1.0,
                    supportedScanTypes: [Html5QrcodeScanType.SCAN_TYPE_CAMERA]
                }, false);

                qrScanner.render(onScanSuccess, onScanFailure);
                
            } catch (error) {
                console.error("QR Scanner initialization failed:", error);
            }
        }

        function onScanSuccess(decodedText, decodedResult) {
            console.log(`QR Code scanned: ${decodedText}`);
            
            // Simulate successful scan
            if (qrScanner) {
                qrScanner.clear();
            }
            
            // Show success animation
            showConfetti = true;
            userPoints += 10;
            
            // Show success message
            setTimeout(() => {
                showConfetti = false;
                setCurrentScreen('home');
            }, 3000);
            
            renderCurrentScreen();
        }

        function onScanFailure(error) {
            // Handle scan failure silently or show error if needed
            console.warn(`QR Code scan error: ${error}`);
        }

        function handleRedeemReward(reward) {
            if (userPoints >= reward.points) {
                selectedReward = reward;
                showRedemptionQR = true;
                userPoints -= reward.points;
                renderCurrentScreen();
                setTimeout(() => {
                    showRedemptionQR = false;
                    selectedReward = null;
                    renderCurrentScreen();
                }, 10000);
            }
        }

        // Enhanced screen components
        function LoginScreen() {
            return `
                <div class="min-h-screen gradient-bg flex flex-col justify-center p-6 animate-fadeIn">
                    <div class="text-center mb-12 animate-slideUp">
                        <div class="bg-white/20 w-20 h-20 rounded-3xl flex items-center justify-center mx-auto mb-6 glass-effect">
                            <i data-lucide="leaf" class="w-10 h-10 text-white"></i>
                        </div>
                        <h1 class="text-4xl font-bold text-white mb-3 drop-shadow-lg">GreenPoints</h1>
                        <p class="text-green-100 text-lg">Turn waste into rewards</p>
                        <div class="flex items-center justify-center mt-4 space-x-2">
                            <div class="w-2 h-2 bg-white/60 rounded-full animate-pulse"></div>
                            <div class="w-2 h-2 bg-white/40 rounded-full animate-pulse" style="animation-delay: 0.2s"></div>
                            <div class="w-2 h-2 bg-white/30 rounded-full animate-pulse" style="animation-delay: 0.4s"></div>
                        </div>
                    </div>
                    
                    <div class="space-y-4 animate-slideUp">
                        <button
                            onclick="setCurrentScreen('onboarding')"
                            class="w-full bg-white text-green-600 py-5 rounded-2xl font-bold text-lg floating-button"
                        >
                            <div class="flex items-center justify-center space-x-2">
                                <i data-lucide="mail" class="w-5 h-5"></i>
                                <span>Sign in with College Email</span>
                            </div>
                        </button>
                        <button
                            onclick="setCurrentScreen('onboarding')"
                            class="w-full glass-effect text-white py-5 rounded-2xl font-semibold text-lg hover:bg-white/20 transition-all duration-300"
                        >
                            <div class="flex items-center justify-center space-x-2">
                                <i data-lucide="user-check" class="w-5 h-5"></i>
                                <span>Guest/Event Pass</span>
                            </div>
                        </button>
                    </div>
                </div>
            `;
        }

        function OnboardingScreen() {
            const slides = [
                {
                    icon: 'qr-code',
                    title: "Scan bin QR ‚Üí Drop waste ‚Üí Earn points",
                    desc: "Find any GreenPoints bin, scan the QR code, and dispose your recyclable waste responsibly."
                },
                {
                    icon: 'gift',
                    title: "Redeem instantly in canteen & stores",
                    desc: "Use your earned points for food discounts, stationery, and exclusive event perks."
                },
                {
                    icon: 'trophy',
                    title: "Climb the leaderboard & win badges",
                    desc: "Compete with friends, unlock achievements, and become the ultimate eco champion!"
                }
            ];

            const currentSlide = slides[onboardingStep];

            return `
                <div class="min-h-screen bg-white flex flex-col animate-fadeIn">
                    <div class="flex-1 flex flex-col justify-center items-center p-6 text-center">
                        <div class="success-gradient w-28 h-28 rounded-3xl flex items-center justify-center mb-8 animate-pulse">
                            <i data-lucide="${currentSlide.icon}" class="w-14 h-14 text-white"></i>
                        </div>
                        <h2 class="text-2xl font-bold text-gray-800 mb-6 leading-tight">${currentSlide.title}</h2>
                        <p class="text-gray-600 text-lg leading-relaxed max-w-sm">${currentSlide.desc}</p>
                    </div>
                    
                    <div class="p-6">
                        <div class="flex justify-center space-x-3 mb-8">
                            ${slides.map((_, index) => 
                                `<div class="w-3 h-3 rounded-full transition-all duration-300 ${index === onboardingStep ? 'bg-green-600 w-8' : 'bg-gray-300'}"></div>`
                            ).join('')}
                        </div>
                        
                        <div class="flex space-x-4">
                            ${onboardingStep > 0 ? `
                                <button
                                    onclick="onboardingStep--; renderCurrentScreen()"
                                    class="flex-1 border-2 border-gray-300 text-gray-600 py-4 rounded-2xl font-semibold hover:bg-gray-50 transition-colors"
                                >
                                    <i data-lucide="arrow-left" class="w-4 h-4 inline mr-2"></i>
                                    Back
                                </button>
                            ` : ''}
                            <button
                                onclick="${onboardingStep < slides.length - 1 ? 'onboardingStep++; renderCurrentScreen()' : 'setCurrentScreen(\'home\')'}"
                                class="flex-1 success-gradient text-white py-4 rounded-2xl font-bold floating-button"
                            >
                                ${onboardingStep < slides.length - 1 ? 'Next' : 'Get Started'}
                                <i data-lucide="arrow-right" class="w-4 h-4 inline ml-2"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        function HomeScreen() {
            return `
                <div class="min-h-screen bg-gray-50 animate-fadeIn">
                    <div class="gradient-bg p-6 pb-16 relative overflow-hidden">
                        <div class="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16"></div>
                        <div class="absolute bottom-0 left-0 w-20 h-20 bg-white/5 rounded-full -ml-10 -mb-10"></div>
                        
                        <div class="flex justify-between items-center mb-8 relative z-10">
                            <div>
                                <h1 class="text-white text-3xl font-bold mb-1">Good Morning! üåÖ</h1>
                                <p class="text-green-100 text-lg">Ready to go green today?</p>
                            </div>
                            <button
                                onclick="setCurrentScreen('profile')"
                                class="w-12 h-12 glass-effect rounded-2xl flex items-center justify-center hover:bg-white/20 transition-colors"
                            >
                                <i data-lucide="user" class="w-6 h-6 text-white"></i>
                            </button>
                        </div>
                        
                        <div class="glass-effect rounded-3xl p-6 mb-4 relative z-10">
                            <div class="flex justify-between items-center mb-4">
                                <span class="text-white font-semibold text-lg">GreenPoints Balance</span>
                                <span class="text-white text-3xl font-bold points-counter">${userPoints}</span>
                            </div>
                            <div class="bg-white/20 rounded-full h-3 mb-3 overflow-hidden">
                                <div 
                                    class="bg-white rounded-full h-3 transition-all duration-1000" 
                                    style="width: ${Math.min((userPoints / 500) * 100, 100)}%"
                                ></div>
                            </div>
                            <p class="text-green-100">${500 - userPoints} pts to Eco Champion badge üèÜ</p>
                        </div>
                    </div>
                    
                    <div class="p-6 -mt-10 relative z-20">
                        <button
                            onclick="setCurrentScreen('scan')"
                            class="w-full success-gradient text-white py-6 rounded-3xl font-bold text-xl mb-8 floating-button animate-pulse"
                        >
                            <div class="flex items-center justify-center space-x-3">
                                <i data-lucide="camera" class="w-7 h-7"></i>
                                <span>üì∑ Scan Bin QR</span>
                                <div class="w-2 h-2 bg-white rounded-full animate-ping"></div>
                            </div>
                        </button>
                        
                        <div class="grid grid-cols-2 gap-6">
                            <button
                                onclick="setCurrentScreen('rewards')"
                                class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100 flex flex-col items-center space-y-3 card-hover"
                            >
                                <div class="w-12 h-12 bg-orange-100 rounded-2xl flex items-center justify-center">
                                    <i data-lucide="gift" class="w-7 h-7 text-orange-500"></i>
                                </div>
                                <span class="font-bold text-gray-800">Rewards Store</span>
                            </button>
                            
                            <button
                                onclick="setCurrentScreen('leaderboard')"
                                class="bg-white p-6 rounded-2xl shadow-lg border border-gray-100 flex flex-col items-center space-y-3 card-hover"
                            >
                                <div class="w-12 h-12 bg-yellow-100 rounded-2xl flex items-center justify-center">
                                    <i data-lucide="trophy" class="w-7 h-7 text-yellow-500"></i>
                                </div>
                                <span class="font-bold text-gray-800">Leaderboard</span>
                            </button>
                        </div>
                        
                        <button
                            onclick="setCurrentScreen('history')"
                            class="w-full bg-white mt-6 p-6 rounded-2xl shadow-lg border border-gray-100 flex items-center justify-between card-hover"
                        >
                            <div class="flex items-center space-x-4">
                                <div class="w-12 h-12 bg-blue-100 rounded-2xl flex items-center justify-center">
                                    <i data-lucide="history" class="w-7 h-7 text-blue-500"></i>
                                </div>
                                <span class="font-bold text-gray-800">My Recycling History</span>
                            </div>
                            <i data-lucide="chevron-right" class="w-5 h-5 text-gray-400"></i>
                        </button>
                    </div>
                    
                    ${showConfetti ? `
                        <div class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 animate-fadeIn">
                            <div class="success-gradient text-white p-10 rounded-3xl shadow-2xl text-center animate-bounce mx-6">
                                <div class="text-7xl mb-6">üéâ</div>
                                <h3 class="text-3xl font-bold mb-3">‚úÖ 10 GreenPoints earned!</h3>
                                <p class="text-green-100 text-lg">Great job recycling!</p>
                                <div class="flex items-center justify-center mt-4 space-x-1">
                                    <div class="w-2 h-2 bg-white/60 rounded-full animate-ping"></div>
                                    <div class="w-2 h-2 bg-white/60 rounded-full animate-ping" style="animation-delay: 0.2s"></div>
                                    <div class="w-2 h-2 bg-white/60 rounded-full animate-ping" style="animation-delay: 0.4s"></div>
                                </div>
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        function ScanScreen() {
            return `
                <div class="min-h-screen bg-gradient-to-br from-gray-900 to-black relative animate-fadeIn">
                    <div class="absolute top-6 left-6 z-20">
                        <button
                            onclick="setCurrentScreen('home'); if(qrScanner) qrScanner.clear();"
                            class="w-12 h-12 glass-effect rounded-2xl flex items-center justify-center hover:bg-white/20 transition-colors"
                        >
                            <i data-lucide="arrow-left" class="w-6 h-6 text-white"></i>
                        </button>
                    </div>
                    
                    <div class="flex flex-col items-center justify-center min-h-screen p-6">
                        <div class="relative mb-8">
                            <div id="qr-reader" class="relative"></div>
                        </div>
                        
                        <div class="text-center">
                            <h2 class="text-white text-2xl font-bold mb-3">üîç Scan QR Code</h2>
                            <p class="text-gray-300 text-lg mb-2">Position QR code inside the frame</p>
                            <p class="text-gray-400">Each bin has a unique time-bound QR code</p>
                            
                            <div class="flex items-center justify-center mt-6 space-x-2">
                                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse" style="animation-delay: 0.3s"></div>
                                <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse" style="animation-delay: 0.6s"></div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function RewardsScreen() {
            return `
                <div class="min-h-screen bg-gray-50 animate-fadeIn">
                    <div class="bg-white shadow-lg p-6 border-b border-gray-200">
                        <div class="flex items-center space-x-4 mb-6">
                            <button
                                onclick="setCurrentScreen('home')"
                                class="p-3 -ml-3 rounded-2xl hover:bg-gray-100 transition-colors"
                            >
                                <i data-lucide="arrow-left" class="w-6 h-6"></i>
                            </button>
                            <h1 class="text-3xl font-bold text-gray-800">üéÅ Rewards Store</h1>
                        </div>
                        <div class="success-gradient p-4 rounded-2xl">
                            <p class="text-white font-bold text-lg text-center">
                                üí∞ Your Balance: <span class="text-2xl">${userPoints}</span> GreenPoints
                            </p>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <div class="space-y-6">
                            ${rewards.map((reward) => {
                                const canAfford = userPoints >= reward.points;
                                
                                return `
                                    <div class="bg-white rounded-2xl p-6 shadow-lg border border-gray-100 card-hover">
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center space-x-4">
                                                <div class="w-16 h-16 rounded-2xl flex items-center justify-center ${reward.color}">
                                                    <i data-lucide="${reward.icon}" class="w-8 h-8"></i>
                                                </div>
                                                <div>
                                                    <h3 class="font-bold text-gray-800 text-lg">${reward.name}</h3>
                                                    <p class="text-green-600 font-bold text-lg">${reward.points} pts</p>
                                                </div>
                                            </div>
                                            <button
                                                onclick="handleRedeemReward(${JSON.stringify(reward).replace(/"/g, '&quot;')})"
                                                ${!canAfford ? 'disabled' : ''}
                                                class="${canAfford 
                                                    ? 'success-gradient text-white hover:shadow-lg floating-button' 
                                                    : 'bg-gray-200 text-gray-400 cursor-not-allowed'} px-6 py-3 rounded-2xl font-bold text-lg"
                                            >
                                                ${canAfford ? '‚ú® Redeem' : 'üîí Locked'}
                                            </button>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                    
                    ${showRedemptionQR && selectedReward ? `
                        <div class="fixed inset-0 bg-black/60 flex items-center justify-center p-6 z-50 animate-fadeIn">
                            <div class="bg-white rounded-3xl p-8 w-full max-w-sm text-center animate-slideUp">
                                <h3 class="text-2xl font-bold mb-6">üéØ Redemption QR Code</h3>
                                <div class="w-56 h-56 mx-auto bg-gradient-to-br from-gray-800 to-gray-900 rounded-3xl mb-6 flex items-center justify-center">
                                    <i data-lucide="qr-code" class="w-40 h-40 text-white animate-pulse"></i>
                                </div>
                                <p class="text-gray-600 mb-3 text-lg">Show this to the vendor</p>
                                <p class="text-red-500 font-bold text-lg mb-4">‚è∞ Expires in 5 minutes</p>
                                <p class="text-xl font-bold mb-6">${selectedReward.name}</p>
                                <button
                                    onclick="showRedemptionQR = false; selectedReward = null; renderCurrentScreen()"
                                    class="w-full bg-gray-200 text-gray-800 py-4 rounded-2xl font-bold text-lg hover:bg-gray-300 transition-colors"
                                >
                                    Close
                                </button>
                            </div>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        function LeaderboardScreen() {
            leaderboard[3].points = userPoints;
            
            return `
                <div class="min-h-screen bg-gray-50 animate-fadeIn">
                    <div class="bg-white shadow-lg p-6 border-b border-gray-200">
                        <div class="flex items-center space-x-4 mb-6">
                            <button
                                onclick="setCurrentScreen('home')"
                                class="p-3 -ml-3 rounded-2xl hover:bg-gray-100 transition-colors"
                            >
                                <i data-lucide="arrow-left" class="w-6 h-6"></i>
                            </button>
                            <h1 class="text-3xl font-bold text-gray-800">üèÜ Leaderboard</h1>
                        </div>
                        
                        <div class="flex space-x-2">
                            <button
                                onclick="activeTab = 'individual'; renderCurrentScreen()"
                                class="px-6 py-3 rounded-2xl font-bold transition-all duration-300 ${
                                    activeTab === 'individual'
                                        ? 'success-gradient text-white shadow-lg'
                                        : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                                }"
                            >
                                üë§ Individual
                            </button>
                            <button
                                onclick="activeTab = 'team'; renderCurrentScreen()"
                                class="px-6 py-3 rounded-2xl font-bold transition-all duration-300 ${
                                    activeTab === 'team'
                                        ? 'success-gradient text-white shadow-lg'
                                        : 'bg-gray-100 text-gray-600 hover:bg-gray-200'
                                }"
                            >
                                üë• Teams
                            </button>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        ${activeTab === 'individual' ? `
                            <div class="space-y-4">
                                ${leaderboard.map((user, index) => `
                                    <div class="bg-white rounded-2xl p-6 shadow-lg border border-gray-100 card-hover ${
                                        user.name === 'You' ? 'ring-2 ring-green-500 bg-green-50' : ''
                                    }">
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center space-x-4">
                                                <div class="w-12 h-12 rounded-2xl flex items-center justify-center text-white font-bold text-lg ${
                                                    index === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600' : 
                                                    index === 1 ? 'bg-gradient-to-br from-gray-400 to-gray-600' : 
                                                    index === 2 ? 'bg-gradient-to-br from-orange-400 to-orange-600' : 'bg-gray-300'
                                                }">
                                                    ${index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : user.rank}
                                                </div>
                                                <div>
                                                    <h3 class="font-bold text-lg ${user.name === 'You' ? 'text-green-800' : 'text-gray-800'}">
                                                        ${user.name}
                                                    </h3>
                                                    <p class="text-sm text-gray-500">${user.dept}</p>
                                                </div>
                                            </div>
                                            <div class="text-right">
                                                <p class="font-bold text-green-600 text-xl">${user.points} pts</p>
                                                <p class="text-xs text-gray-500">${user.badge}</p>
                                            </div>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        ` : `
                            <div class="space-y-4">
                                ${teamLeaderboard.map((team, index) => `
                                    <div class="bg-white rounded-2xl p-6 shadow-lg border border-gray-100 card-hover">
                                        <div class="flex items-center justify-between">
                                            <div class="flex items-center space-x-4">
                                                <div class="w-12 h-12 rounded-2xl flex items-center justify-center text-white font-bold text-lg ${
                                                    index === 0 ? 'bg-gradient-to-br from-yellow-400 to-yellow-600' : 
                                                    index === 1 ? 'bg-gradient-to-br from-gray-400 to-gray-600' : 
                                                    'bg-gradient-to-br from-orange-400 to-orange-600'
                                                }">
                                                    ${index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : 'ü•â'}
                                                </div>
                                                <div>
                                                    <h3 class="font-bold text-lg text-gray-800">${team.name}</h3>
                                                    <p class="text-sm text-gray-500">üë• ${team.members} members</p>
                                                </div>
                                            </div>
                                            <p class="font-bold text-green-600 text-xl">${team.points.toLocaleString()} pts</p>
                                        </div>
                                    </div>
                                `).join('')}
                            </div>
                        `}
                        
                        <div class="mt-8 p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-3xl border border-blue-200">
                            <p class="text-blue-800 font-bold text-center text-lg">
                                üèÜ Weekly reset in 3 days - Keep climbing! üöÄ
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }

        function ProfileScreen() {
            return `
                <div class="min-h-screen bg-gray-50 animate-fadeIn">
                    <div class="gradient-bg p-6 pb-8 relative overflow-hidden">
                        <div class="absolute top-0 right-0 w-40 h-40 bg-white/5 rounded-full -mr-20 -mt-20"></div>
                        <div class="flex items-center space-x-4 mb-8 relative z-10">
                            <button
                                onclick="setCurrentScreen('home')"
                                class="p-3 -ml-3 rounded-2xl glass-effect hover:bg-white/20 transition-colors"
                            >
                                <i data-lucide="arrow-left" class="w-6 h-6 text-white"></i>
                            </button>
                            <h1 class="text-3xl font-bold text-white">üë§ Profile</h1>
                        </div>
                        
                        <div class="glass-effect rounded-3xl p-6 relative z-10">
                            <div class="text-center">
                                <div class="w-20 h-20 bg-white/20 rounded-3xl flex items-center justify-center mx-auto mb-4">
                                    <i data-lucide="user" class="w-10 h-10 text-white"></i>
                                </div>
                                <h2 class="text-white text-2xl font-bold mb-1">You</h2>
                                <p class="text-green-100 text-lg">üíª Computer Science</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="p-6 -mt-4 relative z-20">
                        <div class="grid grid-cols-2 gap-6 mb-8">
                            <div class="bg-white rounded-2xl p-6 text-center shadow-lg border border-gray-100 card-hover">
                                <div class="w-12 h-12 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-3">
                                    <i data-lucide="recycle" class="w-7 h-7 text-green-600"></i>
                                </div>
                                <p class="text-3xl font-bold text-gray-800 mb-1">12 kg</p>
                                <p class="text-sm text-gray-500 font-semibold">Waste Recycled</p>
                            </div>
                            <div class="bg-white rounded-2xl p-6 text-center shadow-lg border border-gray-100 card-hover">
                                <div class="w-12 h-12 bg-green-100 rounded-2xl flex items-center justify-center mx-auto mb-3">
                                    <i data-lucide="leaf" class="w-7 h-7 text-green-600"></i>
                                </div>
                                <p class="text-3xl font-bold text-gray-800 mb-1">3</p>
                                <p class="text-sm text-gray-500 font-semibold">Trees Saved</p>
                            </div>
                        </div>
                        
                        <div class="bg-white rounded-2xl p-6 mb-8 shadow-lg border border-gray-100">
                            <h3 class="font-bold text-gray-800 mb-6 flex items-center space-x-2 text-xl">
                                <i data-lucide="award" class="w-6 h-6"></i>
                                <span>üèÖ Your Badges</span>
                            </h3>
                            <div class="grid grid-cols-2 gap-4">
                                ${badges.map((badge) => `
                                    <div class="p-4 rounded-2xl border-2 transition-all duration-300 ${
                                        badge.unlocked 
                                            ? 'bg-green-50 border-green-200 hover:bg-green-100' 
                                            : 'bg-gray-50 border-gray-200 hover:bg-gray-100'
                                    }">
                                        <div class="text-3xl mb-2 text-center">${badge.icon}</div>
                                        <h4 class="font-bold text-sm text-center ${badge.unlocked ? 'text-green-800' : 'text-gray-400'}">
                                            ${badge.name}
                                        </h4>
                                        <p class="text-xs text-center mt-1 ${badge.unlocked ? 'text-green-600' : 'text-gray-400'}">
                                            ${badge.desc}
                                        </p>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                        
                        <button
                            onclick="setCurrentScreen('history')"
                            class="w-full bg-white rounded-2xl p-6 shadow-lg border border-gray-100 flex items-center justify-between card-hover"
                        >
                            <div class="flex items-center space-x-4">
                                <div class="w-12 h-12 bg-blue-100 rounded-2xl flex items-center justify-center">
                                    <i data-lucide="history" class="w-6 h-6 text-blue-500"></i>
                                </div>
                                <span class="font-bold text-gray-800 text-lg">üìä View Full History</span>
                            </div>
                            <i data-lucide="chevron-right" class="w-6 h-6 text-gray-400"></i>
                        </button>
                    </div>
                </div>
            `;
        }

        function HistoryScreen() {
            return `
                <div class="min-h-screen bg-gray-50 animate-fadeIn">
                    <div class="bg-white shadow-lg p-6 border-b border-gray-200">
                        <div class="flex items-center space-x-4">
                            <button
                                onclick="setCurrentScreen('profile')"
                                class="p-3 -ml-3 rounded-2xl hover:bg-gray-100 transition-colors"
                            >
                                <i data-lucide="arrow-left" class="w-6 h-6"></i>
                            </button>
                            <h1 class="text-3xl font-bold text-gray-800">üìä Recycling History</h1>
                        </div>
                    </div>
                    
                    <div class="p-6">
                        <div class="space-y-6">
                            ${recyclingHistory.map((item) => `
                                <div class="bg-white rounded-2xl p-6 shadow-lg border border-gray-100 card-hover">
                                    <div class="flex items-center justify-between">
                                        <div>
                                            <h3 class="font-bold text-gray-800 text-lg">‚ôªÔ∏è ${item.type}</h3>
                                            <p class="text-gray-500 text-sm mt-1">üìÖ ${item.date}</p>
                                            <p class="text-xs text-gray-400 mt-1">üóÇÔ∏è Bin: ${item.bin}</p>
                                        </div>
                                        <div class="text-right">
                                            <p class="font-bold text-green-600 text-xl mb-2">+${item.points} pts</p>
                                            <div class="w-10 h-10 bg-green-100 rounded-full flex items-center justify-center">
                                                <i data-lucide="check" class="w-5 h-5 text-green-500"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                        
                        <div class="mt-8 p-6 success-gradient rounded-3xl text-center">
                            <p class="text-white font-bold text-xl mb-2">üå± Your recycling = 3 trees saved!</p>
                            <p class="text-green-100 text-lg">Keep up the great work! üöÄ</p>
                        </div>
                    </div>
                </div>
            `;
        }

        // Render function
        function renderCurrentScreen() {
            const app = document.getElementById('app');
            
            switch(currentScreen) {
                case 'login':
                    app.innerHTML = LoginScreen();
                    break;
                case 'onboarding':
                    app.innerHTML = OnboardingScreen();
                    break;
                case 'home':
                    app.innerHTML = HomeScreen();
                    break;
                case 'scan':
                    app.innerHTML = ScanScreen();
                    setTimeout(() => {
                        initQRScanner();
                    }, 100);
                    break;
                case 'rewards':
                    app.innerHTML = RewardsScreen();
                    break;
                case 'leaderboard':
                    app.innerHTML = LeaderboardScreen();
                    break;
                case 'profile':
                    app.innerHTML = ProfileScreen();
                    break;
                case 'history':
                    app.innerHTML = HistoryScreen();
                    break;
                default:
                    app.innerHTML = LoginScreen();
            }
            
            // Initialize Lucide icons
            lucide.createIcons();
        }

        // Initialize app
        renderCurrentScreen();
    </script>
</body>
</html>
